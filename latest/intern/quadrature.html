<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quadrature · NESSie.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/highlightjs/default.css" rel="stylesheet" type="text/css"/><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>NESSie.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" action="../search.html"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../index.html">Home</a></li><li><span class="toctext">Manual</span><ul><li><a class="toctext" href="../man/introduction.html">Introduction</a></li><li><a class="toctext" href="../man/references.html">Bibliography</a></li></ul></li><li><span class="toctext">Data formats</span><ul><li><a class="toctext" href="../formats/input.html">Input formats</a></li><li><a class="toctext" href="../formats/output.html">Output formats</a></li></ul></li><li><span class="toctext">Library</span><ul><li><a class="toctext" href="../lib/constants.html">Constants</a></li><li><a class="toctext" href="../lib/electrostatics.html">Electrostatics</a></li><li><a class="toctext" href="../lib/models.html">Models</a></li><li><a class="toctext" href="../lib/quadrature.html">Quadrature</a></li><li><a class="toctext" href="../lib/solvers.html">Solvers</a></li><li><a class="toctext" href="../lib/util.html">Utility functions</a></li></ul></li><li><span class="toctext">Internals</span><ul><li><a class="toctext" href="constants.html">Constants</a></li><li><a class="toctext" href="input.html">Input formats</a></li><li class="current"><a class="toctext" href="quadrature.html">Quadrature</a><ul class="internal"><li><a class="toctext" href="#Radon-cubature-1">Radon cubature</a></li><li><a class="toctext" href="#Rjasanow-1">Rjasanow</a></li></ul></li><li><a class="toctext" href="util.html">Utility functions</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li>Internals</li><li><a href="quadrature.html">Quadrature</a></li></ul><a class="edit-page" href="https://github.com/tkemmer/nessie.jl/tree/master/doc/src/intern/quadrature.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Quadrature</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="int-quadrature-1" href="#int-quadrature-1">Quadrature</a></h1><h2><a class="nav-anchor" id="Radon-cubature-1" href="#Radon-cubature-1">Radon cubature</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="NESSie.Radon.radoncoll!" href="#NESSie.Radon.radoncoll!"><code>NESSie.Radon.radoncoll!</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">radoncoll!{T}(
        dest    ::DenseArray{T,1},
        elements::Vector{Triangle{T}},
        Ξ       ::Vector{Vector{T}},
        solution::Function,
        yukawa  ::T,
        fvals   ::DenseArray{T,1}
)

radoncoll!{T}(
        dest    ::DenseArray{T,2},
        elements::Vector{Triangle{T}},
        Ξ       ::Vector{Vector{T}},
        solution::Function,
        yukawa  ::T
)</code></pre><p>Seven-point Radon cubature <a href="../man/references.html#Bibliography-1">[Rad48]</a> for a given function and a list of triangles and observation points <code>Ξ</code>. If <code>dest</code> is a vector, the function values f for each surface triangle have to be specified, since each element of the vector represents the dot product of the corresponding coefficient matrix row and the <code>fvals</code> vector.</p><p>If you intend computing single/double layer potentials with this function, you might want to use the shorthand signature <code>regularyukawacoll!</code> instead.</p><div class="admonition note"><div class="admonition-title">Note</div><div class="admonition-text"><p>The result is premultiplied by 4π.</p></div></div><p><strong>Arguments</strong></p><ul><li><p><code>solution</code> Fundamental solution; supported functions: <code>regularyukawapot</code>, <code>∂ₙregularyukawapot</code></p></li><li><p><code>yukawa</code> <a href="constants.html#int-constants-1">Exponent</a> of the Yukawa operator&#39;s fundamental solution</p></li></ul><p><strong>Return type</strong></p><p><code>Void</code></p></div><a class="source-link" target="_blank" href="https://github.com/tkemmer/nessie.jl/tree/master/src/Radon.jl">source</a><br/></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="NESSie.Radon.regularyukawapot" href="#NESSie.Radon.regularyukawapot"><code>NESSie.Radon.regularyukawapot</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">regularyukawapot{T}(
    x     ::DenseArray{T,1},
    ξ     ::Vector{T},
    yukawa::T,
          ::Vector{T}=T[]
)</code></pre><p>Computes the regular part of the Yukawa potential, that is, Yukawa minus Laplace:</p><div>\[\frac{e^{Λ |x - ξ|} - 1}{|x-ξ|}\]</div><div class="admonition note"><div class="admonition-title">Note</div><div class="admonition-text"><p>The result is premultiplied by 4π.</p></div></div><p><strong>Arguments</strong></p><ul><li><p><code>yukawa</code> <a href="constants.html#int-constants-1">Exponent</a> of the Yukawa operator&#39;s fundamental solution</p></li></ul><p><strong>Return type</strong></p><p><code>T</code></p></div><a class="source-link" target="_blank" href="https://github.com/tkemmer/nessie.jl/tree/master/src/Radon.jl">source</a><br/></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="NESSie.Radon.∂ₙregularyukawapot" href="#NESSie.Radon.∂ₙregularyukawapot"><code>NESSie.Radon.∂ₙregularyukawapot</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">∂ₙregularyukawapot{T}(
    x     ::Vector{T},
    ξ     ::Vector{T},
    yukawa::T,
    normal::Vector{T}
)</code></pre><p>Computes the normal derivative of the regular part of the Yukawa potential, that is, Yukawa minus Laplace:</p><div>\[\frac{∂}{∂n} \frac{e^{Λ  |x - ξ|} - 1}{|x-ξ|}
= \frac{1 - (1 - Λ  |x - ξ|)e^{Λ  |x - ξ|}}{|x-ξ|²} \frac{(x - ξ) ⋅ n}{|x - ξ|}\]</div><div class="admonition note"><div class="admonition-title">Note</div><div class="admonition-text"><p>The result is premultiplied by 4π.</p></div></div><p><strong>Arguments</strong></p><ul><li><p><code>yukawa</code> <a href="constants.html#int-constants-1">Exponent</a> of the Yukawa operator&#39;s fundamental solution</p></li></ul><p><strong>Return type</strong></p><p><code>T</code></p></div><a class="source-link" target="_blank" href="https://github.com/tkemmer/nessie.jl/tree/master/src/Radon.jl">source</a><br/></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="NESSie.Radon.setcubpts!" href="#NESSie.Radon.setcubpts!"><code>NESSie.Radon.setcubpts!</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">setcubpts!{T}(
    dest::Vector{Vector{T}},
    qpts::QuadPts2D{T},
    elem::Triangle{T}
)</code></pre><p>Prepare cubature points for one surface element.</p><p><strong>Return type</strong></p><p><code>Void</code></p></div><a class="source-link" target="_blank" href="https://github.com/tkemmer/nessie.jl/tree/master/src/Radon.jl">source</a><br/></section><h2><a class="nav-anchor" id="Rjasanow-1" href="#Rjasanow-1">Rjasanow</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="NESSie.Rjasanow.ObservationPosition" href="#NESSie.Rjasanow.ObservationPosition"><code>NESSie.Rjasanow.ObservationPosition</code></a> — <span class="docstring-category">Type</span>.</div><div><pre><code class="language-none">abstract type ObservationPosition end
struct InPlane &lt;: ObservationPosition end
stryct InSpace &lt;: ObservationPosition end</code></pre><p>Enum-like representation of the obseration point&#39;s position relative to the corresponding surface element</p></div><a class="source-link" target="_blank" href="https://github.com/tkemmer/nessie.jl/tree/master/src/Rjasanow.jl">source</a><br/></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="NESSie.Rjasanow.InPlane" href="#NESSie.Rjasanow.InPlane"><code>NESSie.Rjasanow.InPlane</code></a> — <span class="docstring-category">Type</span>.</div><div><pre><code class="language-none">abstract type ObservationPosition end
struct InPlane &lt;: ObservationPosition end
stryct InSpace &lt;: ObservationPosition end</code></pre><p>Enum-like representation of the obseration point&#39;s position relative to the corresponding surface element</p></div><a class="source-link" target="_blank" href="https://github.com/tkemmer/nessie.jl/tree/master/src/Rjasanow.jl">source</a><br/></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="NESSie.Rjasanow.InSpace" href="#NESSie.Rjasanow.InSpace"><code>NESSie.Rjasanow.InSpace</code></a> — <span class="docstring-category">Type</span>.</div><div><pre><code class="language-none">abstract type ObservationPosition end
struct InPlane &lt;: ObservationPosition end
stryct InSpace &lt;: ObservationPosition end</code></pre><p>Enum-like representation of the obseration point&#39;s position relative to the corresponding surface element</p></div><a class="source-link" target="_blank" href="https://github.com/tkemmer/nessie.jl/tree/master/src/Rjasanow.jl">source</a><br/></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="NESSie.Rjasanow.laplacepot" href="#NESSie.Rjasanow.laplacepot"><code>NESSie.Rjasanow.laplacepot</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">function laplacepot{T, P &lt;: PotentialType}(
    ptype::Type{P},
    ξ    ::Vector{T},
    elem ::Triangle{T},
    dist ::T
)</code></pre><p>Computes the single or double layer Laplace potential of the given triangle for the given observation point <code>ξ</code>. The latter needs to be projected onto the surface element plane <a href="../man/references.html#Bibliography-1">[Rja90]</a>.</p><div class="admonition note"><div class="admonition-title">Note</div><div class="admonition-text"><p>The result is premultiplied by 4π.</p></div></div><p><strong>Arguments</strong></p><ul><li><p><code>dist</code> Distance from the original <code>ξ</code> to the surface element plane</p></li></ul><p><strong>Return type</strong></p><p><code>T</code></p></div><a class="source-link" target="_blank" href="https://github.com/tkemmer/nessie.jl/tree/master/src/Rjasanow.jl">source</a><br/><div><pre><code class="language-none">laplacepot{T, P &lt;: PotentialType}(
    ptype::Type{P},
    ξ::Vector{T},
    x1::Vector{T},
    x2::Vector{T},
    normal::Vector{T},
    dist::T
)</code></pre><p>Computes the single or double layer Laplace potential of the triangle defined by the observation point <code>ξ</code> and two nodes <code>x1</code> and <code>x2</code> of the surface element. <code>x2</code> is required to be <code>x1</code>&#39;s next neighbor in counterclockwise direction. Also, <code>ξ</code> needs to be projected onto the surface element plane  <a href="../man/references.html#Bibliography-1">[Rja90]</a>.</p><div class="admonition note"><div class="admonition-title">Note</div><div class="admonition-text"><p>The result is premultiplied by 4π.</p></div></div><p><strong>Arguments</strong></p><ul><li><p><code>normal</code> Unit normal vector of the surface element</p></li><li><p><code>dist</code> Distance from the original <code>ξ</code> to the surface element plane</p></li></ul><p><strong>Return type</strong></p><p><code>T</code></p></div><a class="source-link" target="_blank" href="https://github.com/tkemmer/nessie.jl/tree/master/src/Rjasanow.jl">source</a><br/><div><pre><code class="language-none">laplacepot{T, P &lt;: PotentialType, O &lt;: ObservationPosition}(
         ::Type{P},
         ::Type{O},
    sinφ1::T,
    sinφ2::T,
    h    ::T,
    d    ::T
)</code></pre><p>Computes the Laplace potential (or its normal derivative) of the triangle with the given height <code>h</code> at the observation point <code>ξ</code> (projected onto the surface element plane) and the sines of the angles <span>$φ₁$</span> and <span>$φ₂$</span> between <code>h</code> and the triangle sides extending from <code>ξ</code> <a href="../man/references.html#Bibliography-1">[Rja90]</a>.</p><div class="admonition note"><div class="admonition-title">Note</div><div class="admonition-text"><p>The result is premultiplied by 4π.</p></div></div><p><strong>Arguments</strong></p><ul><li><p><code>d</code> Distance from the original <code>ξ</code> to the surface element plane</p></li></ul><p><strong>Return type</strong></p><p><code>T</code></p></div><a class="source-link" target="_blank" href="https://github.com/tkemmer/nessie.jl/tree/master/src/Rjasanow.jl">source</a><br/></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="NESSie.Rjasanow.logterm" href="#NESSie.Rjasanow.logterm"><code>NESSie.Rjasanow.logterm</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">logterm{T}(χ2::T, sinφ::T)</code></pre><p>Utility function to compute</p><div>\[\frac
{\sqrt{1 - χ² \sin²(φ)} + \sqrt{1 - χ² \sin(φ)}}
{\sqrt{1 - χ² \sin²(φ)} - \sqrt{1 - χ² \sin(φ)}}\]</div><p><strong>Return type</strong></p><p><code>T</code></p></div><a class="source-link" target="_blank" href="https://github.com/tkemmer/nessie.jl/tree/master/src/Rjasanow.jl">source</a><br/></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="NESSie.Rjasanow.projectξ" href="#NESSie.Rjasanow.projectξ"><code>NESSie.Rjasanow.projectξ</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">projectξ{T}(ξ::Vector{T}, elem::Triangle{T})</code></pre><p>Projects ξ onto the surface element plane. Returns the projection and the original distance to the plane.</p><p><strong>Return type</strong></p><p><code>Tuple{Vector{T}, T}</code></p></div><a class="source-link" target="_blank" href="https://github.com/tkemmer/nessie.jl/tree/master/src/Rjasanow.jl">source</a><br/></section><footer><hr/><a class="previous" href="input.html"><span class="direction">Previous</span><span class="title">Input formats</span></a><a class="next" href="util.html"><span class="direction">Next</span><span class="title">Utility functions</span></a></footer></article></body></html>
